#!/bin/zsh

percent=`pmset -g ps | grep -o '[0-9]\+%' | tr -d '%'`
pmset -g ps | grep -E "Battery Power|charged" >/dev/null 2>&1
if [ $? -eq 0  ]; then

  time=`pmset -g ps | grep -o '[0-9]\+:[0-9]\+'`
  
  if [ -z "$time" ]; then
    if [ $percent -le 20 ] ; then
      echo -e "#[bg=colour001] ${percent}% #[default]"
    else
      echo -e "#[bg=colour004] ${percent}% #[default]"
    fi
  else
    if [ $percent -le 20 ] ; then
      echo -e "#[bg=colour001] ${percent}% (${time}) #[default]"
    else
      echo -e "#[bg=colour004] ${percent}% (${time}) #[default]"
    fi
  fi
else
  echo -e "#[bg=colour04] ${percent}% #[default]"
fi
